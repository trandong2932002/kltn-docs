\begin{tikzpicture}
    \begin{scope}[step=0.5cm, gray, very thin]
        \draw (0,0) grid (3.5,3.5);
        \draw (5-0.001,1-0.001) grid (6.5,2.5);
        \draw (8-0.001,0.5) grid (10.5,3);
    \end{scope}

    \begin{scope}[gray, opacity=0.3]
        \fill (0.5,0) rectangle (2,1.5);
        \fill (8.5,0.5) rectangle (9,1);
    \end{scope}

    \begin{scope}[dashed]
        \draw (0.5,0) -- (5,1);
        \draw (2,0) -- (6.5,1);
        \draw (2,1.5) -- (5,1.5+2/3); % (6.5,2.5)
        \draw (0.5,1.5) -- (5,2.5);

        \draw (5,1) -- (8.5,0.5);
        \draw (6.5,1) -- (9,0.5);
        \draw (6.5,2.5) -- (9,1);
        \draw (5,2.5) -- (8.5,1);
    \end{scope}

    \begin{scope}
        \node at (3.5/2,4) {đầu vô};
        \node at (5+1.5/2,3) {bộ lọc};
        \node at (8+2.5/2,3.5) {đầu ra};
    \end{scope}
\end{tikzpicture}